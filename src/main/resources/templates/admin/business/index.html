<!doctype html>
<html lang="kr" class="semi-dark">
<head th:replace="~{admin/includes/head.html}"></head>
<body>
<!--wrapper-->
<div id="bodyWrap">
    <!--sidebar wrapper -->
    <th:block th:insert="~{admin/includes/header.html}"/>
    <div id="sub" class="">
        <div class="sub_visual">
            <div class="sub_tit">
                <h2 th:text="${cm.title}"></h2>
            </div>
            <form action="/admin/business/member/download/excel">
                <button class="btn border222 excel-btn"><img src="/admin/images/ico_download.svg" width="14">엑셀 다운로드</button>
                <input type="hidden" name="sd" th:value="${param?.sd}">
                <input type="hidden" name="ed" th:value="${param?.ed}">
                <input type="hidden" name="dt" th:value="${param?.dt}">
                <input type="hidden" name="t" th:value="${param?.t}">
                <input type="hidden" name="q" th:value="${param?.q}">
            </form>
        </div>

        <!-- 본문 시작 -->
        <div class="sec_wrap">
            <div class="section section1">
                <div class="inner">
                    <div>
                        <form id="searchForm" th:action="${cm.link}">
                            <!--<div class="tab-box mb30">
                                <input type="radio" value="0" id="type0" name="bt"
                                       th:checked="${param.bt eq null || param.bt == 0}">
                                <label for="type0">사업자</label>
                                &lt;!&ndash;<input type="radio" value="1" id="type1" name="bt">
                                <label for="type1">가맹점</label>&ndash;&gt;
                            </div>-->
                            <div class="searchWrap">
                                <table class="searchTable">
                                    <caption> 게시글검색</caption>
                                    <colgroup>
                                        <col width="10.3%">
                                        <col width="40%">
                                        <col width="10.3%">
                                        <col width="40%">
                                    </colgroup>
                                    <tbody>
                                    <tr>
                                        <td>
                                            <select name="dt" class="select_drop" style="display: none;">
                                                <option value="m_crdt">가입일</option>
                                                <option value="m_lldt">최근 로그인일자</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="regist_date">
                                                <div class="calendar_wrap clear">
                                                    <p class="calendar">
                                                        <input type="text" class="input datepicker" name="sd"
                                                               readonly="readonly" th:value="${param.sd}">
                                                        <span class="calendar_ico"><img
                                                                src="/admin/images/ico_calendar.svg"></span>
                                                    </p>
                                                    <span>~</span>
                                                    <p class="calendar">
                                                        <input type="text" class="input datepicker" name="ed"
                                                               readonly="readonly" th:value="${param.ed}">
                                                        <span class="calendar_ico"><img
                                                                src="/admin/images/ico_calendar.svg"></span>
                                                    </p>
                                                </div>
                                                <div class="period">
                                                    <!-- 기간 클릭했을때 class="on" 추가 부탁드립니다. -->
                                                    <input type="button" value="금일" class="month_btn">
                                                    <input type="button" value="1개월" class="month_btn">
                                                    <input type="button" value="3개월" class="month_btn">
                                                    <input type="button" value="6개월" class="month_btn">
                                                    <input type="button" value="1년" class="month_btn">
                                                </div>
                                            </div>
                                        </td>
                                        <th>검색어</th>
                                        <td colspan="3">
                                            <div class="srch_word">
                                                <div class="wte_word clear">
                                                    <select name="t" class="select_drop" style="display: none;">
                                                        <option value="">전체</option>
                                                        <option value="id">사업자등록번호</option>
                                                        <option value="company_name">회사명</option>
                                                        <option value="master_cell">대표번호</option>
                                                    </select>
                                                    <input type="text" name="q" class="search_val1">
                                                </div>
                                                <div class="btn_box btn_box2 clear">
                                                    <input type="submit" value="검색" class="btn_search">
                                                    <input type="reset" value="초기화" class="btn_search">
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <input type="hidden" name="p" id="page" th:value="${data.curPage}">
                        </form>
                    </div>
                    <!-- //search_warp -->
                    <form class="form-inline" method="post" accept-charset="utf-8" onsubmit="return deleteCheck(this);">
                        <div class="tbl_area">
                            <div class="tbl_tit">
                                전체 <strong th:text="${data.count}"></strong><em>건</em>
                                <!--<span>(<i
                                    th:text="${data.curPage}"></i>/<i th:text="${data.lastPage}"></i> 페이지)</span>-->
                            </div>
                            <div class="scroll_list_wrap">
                                <div class="tbl_box tbl_box5 list-page">
                                    <table>
                                        <caption>목록</caption>
                                        <colgroup>
                                            <col width="70px">
                                            <col width="70px">
                                            <col width="10%">
                                            <col width="*">
                                            <col width="15%">
                                            <col width="15%">
                                            <col width="15%">
                                            <col width="15%">
                                            <col width="7%">
                                        </colgroup>
                                        <thead>
                                        <tr>
                                            <th class="chk_th" scope="col">
                                                <div class="check_box">
                                                    <input type="checkbox" id="all_chk">
                                                    <label for="all_chk">전체선택</label>
                                                </div>
                                            </th>
                                            <th scope="col">번호</th>
                                            <th scope="col">사업자등록번호</th>
                                            <th scope="col">회사명</th>
                                            <th scope="col">대표번호</th>
                                            <th scope="col">최근 로그인일자</th>
                                            <th scope="col">가입일</th>
                                            <th scope="col">가입승인상태</th>
                                            <th scope="col">포인트조회</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr th:if="${data.count == 0}">
                                            <td colspan="9">가입한 회원이 없습니다.</td>
                                        </tr>
                                        <tr th:if="${data.count > 0}" th:each="row : ${data.list}">
                                            <td class="chk_td">
                                                <div class="check_box">
                                                    <input type="checkbox" th:id="'chk_'+${row.idx}" name="idx"
                                                           class="list-chkbox" th:value="${row.idx}">
                                                    <label th:for="'chk_'+${row.idx}"></label>
                                                </div>
                                            </td>
                                            <td th:data-idx="${row.idx}" th:text="${row.row_num}"></td>
                                            <td th:data-idx="${row.idx}" th:text="${row.id}"></td>
                                            <td th:data-idx="${row.idx}" class="txt_l"
                                                th:text="${row.name}"></td>
                                            <td th:data-idx="${row.idx}" th:text="${row.business.master_cell}"></td>
                                            <td th:data-idx="${row.idx}"
                                                th:text="${#dates.format(row.latest_logged_at, 'yyyy-MM-dd HH:mm:ss')}"></td>
                                            <td th:data-idx="${row.idx}"
                                                th:text="${#dates.format(row.created_at, 'yyyy-MM-dd HH:mm:ss')}"></td>

                                            <!--

                                            가입 승인 상태에 따라 클래스 변경
                                            탈퇴, 완료 x
                                            대기 txt-red

                                            -->
                                            <td th:data-idx="${row.idx}" th:text="${row.statusToString()}"></td>

                                            <td>
                                                <button type="button" th:data-member-idx="${row.idx}" class="btn btn-primary m0auto point-btn">조회하기
                                                </button>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div><!-- //tbl_area -->
                        <div class="btnSet clear">
                            <div class="left">
                                <button type="button" class="btn border222" onclick="openPopup('#send_alarm_pooup', 'normal')">알림발송</button>
                            </div>
                        </div>
                    </form>
                    <th:block th:insert="~{admin/includes/page_nation.html}"></th:block>
                </div>
            </div>
        </div>
    </div>
    <th:block th:insert="~{admin/includes/footer.html}"/>
    <th:block th:insert="~{admin/member/popup/send_alarm_pooup.html}"/>
</div>
<!--end wrapper-->
<!--start switcher-->
<script src="/admin/js/index.js" type="text/javascript"></script>
<script>
    $(".point-btn").click(function() {
        const member_idx = $(this).data("member-idx");
        const width = 960;
        const height = 1011.5;
        openWindowPopup({
            url: `/admin/point/member/popup/${member_idx}`,
            width,
            height
        })
    });
</script>
</body>
</html>